<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin - E.I.O</title>
    <link rel="stylesheet" href="design-system.css?v=11">
    <link rel="stylesheet" href="dashboard.css?v=11">
    <link rel="stylesheet" href="admin.css?v=11">
    <link rel="stylesheet" href="fix-spacing.css?v=11">

    <!-- ‚úÖ FIX SPACING INLINE - ADMIN -->
    <style>
        /* FOR√áA ABSOLUTA - Remover TODOS os espa√ßos superiores */
        .eio-page-content {
            padding-top: 0 !important;
            margin-top: 0 !important;
            padding-left: 24px !important;
            padding-right: 24px !important;
        }

        .eio-page-content>*,
        .eio-page-content>*:first-child,
        .eio-page-content>div:first-child,
        .eio-page-content>div {
            margin-top: 0 !important;
        }

        .eio-content-section,
        .eio-content-section.eio-content-active {
            margin-top: 0 !important;
            padding-top: 16px !important;
        }

        .eio-section-header-dash {
            margin-top: 0 !important;
            padding-top: 0 !important;
            margin-bottom: 16px !important;
        }

        .eio-card,
        .eio-card:first-child,
        .eio-stats-grid,
        .eio-stats-grid:first-child,
        .eio-section-header-dash+*,
        .eio-kpi-grid,
        .eio-dashboard-grid,
        .eio-kanban-board,
        .eio-messages-container,
        .eio-admin-table {
            margin-top: 0 !important;
        }

        .eio-topbar {
            padding-top: 12px !important;
            padding-bottom: 12px !important;
        }

        /* Remove margin de cards com style inline */
        [style*="margin-top"] {
            margin-top: 8px !important;
        }

        /* Remove padding extra de todas as se√ß√µes */
        div[data-section] {
            padding-top: 16px !important;
            margin-top: 0 !important;
        }

        /* For√ßa o primeiro elemento de cada se√ß√£o */
        div[data-section]>*:first-child,
        div[data-section]>div:first-child {
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        /* Admin espec√≠fico */
        .eio-admin-card {
            margin-top: 0 !important;
        }

        table {
            margin-top: 0 !important;
        }

        .eio-card-header+table,
        .eio-card-header+.eio-admin-table {
            margin-top: 0 !important;
        }
    </style>
</head>

<body class="eio-dashboard-body">
    <!-- Sidebar -->
    <aside class="eio-sidebar">
        <div class="eio-sidebar-header">
            <img src="public/assets/official_brand_rocket.png" alt="E.I.O" class="eio-sidebar-logo">
            <div class="eio-sidebar-title">
                <span class="eio-title-main">E.I.O</span>
                <span class="eio-title-sub">Admin Panel</span>
            </div>
        </div>

        <nav class="eio-sidebar-nav">
            <a href="#overview" class="eio-nav-item eio-nav-item-active" data-page="overview">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <rect x="3" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="11" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="3" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="11" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="2" />
                </svg>
                <span>Dashboard</span>
            </a>

            <a href="#users" class="eio-nav-item" data-page="users">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M13 14C13 12.3431 11.6569 11 10 11H6C4.34315 11 3 12.3431 3 14V17H13V14Z"
                        stroke="currentColor" stroke-width="2" />
                    <circle cx="8" cy="6" r="3" stroke="currentColor" stroke-width="2" />
                </svg>
                <span>Usu√°rios</span>
            </a>

            <a href="#subscriptions" class="eio-nav-item" data-page="subscriptions">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <rect x="3" y="4" width="14" height="12" rx="2" stroke="currentColor" stroke-width="2" />
                    <path d="M3 8H17" stroke="currentColor" stroke-width="2" />
                </svg>
                <span>Assinaturas</span>
            </a>

            <a href="#automations" class="eio-nav-item" data-page="automations">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M10 2L3 7L10 12L17 7L10 2Z" stroke="currentColor" stroke-width="2" />
                    <path d="M3 12L10 17L17 12" stroke="currentColor" stroke-width="2" />
                </svg>
                <span>Mensagens Auto</span>
            </a>

            <a href="#finances" class="eio-nav-item" data-page="finances">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="2" />
                    <path d="M10 6V10L13 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                <span>Financeiro</span>
            </a>

            <a href="#logs" class="eio-nav-item" data-page="logs">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M3 3H17V17H3V3Z" stroke="currentColor" stroke-width="2" />
                    <path d="M6 7H14M6 10H14M6 13H10" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                <span>Logs</span>
            </a>
        </nav>

        <div class="eio-sidebar-footer">
            <a href="dashboard.html" class="eio-btn eio-btn-primary eio-btn-sm" style="width: 100%;"
                id="btnSwitchToUser">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" />
                </svg>
                Meu Perfil de Usu√°rio
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="eio-main-content">
        <!-- Topbar -->
        <header class="eio-topbar">
            <div class="eio-topbar-left">
                <h1 class="eio-page-title">Dashboard Admin</h1>
            </div>

            <div class="eio-topbar-right">
                <div class="eio-user-menu" id="userMenuToggle" style="cursor: pointer;">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=admin" alt="Admin" class="eio-avatar"
                        id="adminAvatar">
                    <div class="eio-user-info">
                        <span class="eio-user-name" id="adminName">Administrador</span>
                        <span class="eio-user-email" id="adminEmail">admin</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <div class="eio-page-content" id="pageContent">
            <!-- Overview Section -->
            <div class="eio-content-section eio-content-active" data-section="overview">
                <!-- Admin Stats Grid -->
                <div class="eio-stats-grid">
                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Total de Usu√°rios</span>
                            <div class="eio-stat-icon eio-stat-icon-blue">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path
                                        d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21"
                                        stroke="currentColor" stroke-width="2" />
                                    <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-total-users">0</div>
                    </div>

                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Receita Estimada (MRR)</span>
                            <div class="eio-stat-icon eio-stat-icon-purple">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path
                                        d="M12 2V22M17 5H9.5C8.57174 5 7.6815 5.36875 7.02513 6.02513C6.36875 6.6815 6 7.57174 6 8.5C6 9.42826 6.36875 10.3185 7.02513 10.9749C7.6815 11.6313 8.57174 12 9.5 12H14.5C15.4283 12 16.3185 12.3687 16.9749 13.0251C17.6313 13.6815 18 14.5717 18 15.5C18 16.4283 17.6313 17.3185 16.9749 17.9749C16.3185 18.6313 15.4283 19 14.5 19H6"
                                        stroke="currentColor" stroke-width="2" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-mrr">R$ 0,00</div>
                    </div>

                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Assinaturas Ativas</span>
                            <div class="eio-stat-icon eio-stat-icon-cyan">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path
                                        d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                                        stroke="currentColor" stroke-width="2" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-active-subs">0</div>
                    </div>

                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Total de Leads</span>
                            <div class="eio-stat-icon eio-stat-icon-orange">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-total-leads">0</div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="eio-admin-grid">
                    <div class="eio-card eio-card-large">
                        <div class="eio-card-header">
                            <h3>Receita dos √öltimos 30 Dias</h3>
                        </div>
                        <div class="eio-chart-container">
                            <canvas id="revenueChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>

                    <div class="eio-card">
                        <div class="eio-card-header">
                            <h3>Novos Usu√°rios</h3>
                        </div>
                        <div class="eio-chart-container">
                            <canvas id="usersChart" style="max-height: 240px;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="eio-card">
                    <div class="eio-card-header">
                        <h3>Atividade Recente</h3>
                    </div>
                    <div class="eio-admin-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Usu√°rio</th>
                                    <th>A√ß√£o</th>
                                    <th>Status</th>
                                    <th>Data</th>
                                </tr>
                            </thead>
                            <tbody id="recentActivityBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Users Section -->
            <div class="eio-content-section" data-section="users">
                <div class="eio-card">
                    <div class="eio-card-header">
                        <h3>Gerenciar Usu√°rios</h3>
                        <div style="display: flex; gap: var(--spacing-md);">
                            <input type="search" class="eio-input" placeholder="Buscar usu√°rios..."
                                style="width: 300px;" id="searchUsers">
                            <button class="eio-btn eio-btn-primary" id="btnAddUser">+ Adicionar Usu√°rio</button>
                        </div>
                    </div>
                    <div class="eio-admin-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Usu√°rio</th>
                                    <th>Email</th>
                                    <th>Plano</th>
                                    <th>Status</th>
                                    <th>M√©todo Pgto</th>
                                    <th>Cadastro</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Subscriptions Section -->
            <div class="eio-content-section" data-section="subscriptions">
                <div class="eio-stats-grid" style="margin-bottom: 30px;">
                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Assinaturas Ativas</span>
                            <div class="eio-stat-icon eio-stat-icon-blue">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path
                                        d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                                        stroke="currentColor" stroke-width="2" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-subs-active">0</div>
                        <div class="eio-stat-change eio-stat-positive" id="stat-subs-retention">--</div>
                    </div>
                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Em Trial</span>
                            <div class="eio-stat-icon eio-stat-icon-cyan">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                    <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-subs-trial">0</div>
                        <div class="eio-stat-change eio-stat-positive">Em per√≠odo de teste</div>
                    </div>
                </div>

                <div class="eio-card">
                    <div class="eio-card-header">
                        <h3>Hist√≥rico de Assinaturas</h3>
                    </div>
                    <div class="eio-admin-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Cliente</th>
                                    <th>Plano</th>
                                    <th>Status</th>
                                    <th>Valor</th>
                                    <th>Pr√≥ximo Pagamento</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="subscriptionsTableBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Automations Section (Mensagens Autom√°ticas) -->
            <div class="eio-content-section" data-section="automations">
                <div class="eio-card">
                    <div class="eio-card-header">
                        <h3>Mensagens Autom√°ticas do Sistema</h3>
                        <span class="eio-badge eio-badge-info">Configure as mensagens enviadas automaticamente</span>
                    </div>

                    <div style="padding: 20px;">
                        <!-- Boas-vindas -->
                        <div
                            style="background: rgba(0,210,255,0.1); border: 1px solid rgba(0,210,255,0.3); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <div>
                                    <h4 style="color: #00d2ff; margin: 0;">üéâ Boas-vindas a Novos Usu√°rios</h4>
                                    <p style="color: rgba(255,255,255,0.6); font-size: 0.85rem; margin: 5px 0 0;">
                                        Enviada automaticamente ap√≥s o cadastro</p>
                                </div>
                                <label class="eio-switch">
                                    <input type="checkbox" id="toggleWelcome" checked>
                                    <span class="eio-switch-slider"></span>
                                </label>
                            </div>
                            <textarea class="eio-input" id="msgWelcome" rows="3" style="width: 100%;">Ol√° {nome}! üöÄ

Bem-vindo(a) ao E.I.O System! Seu per√≠odo de teste de 5 dias come√ßou.

Qualquer d√∫vida, estamos √† disposi√ß√£o!
Equipe E.I.O</textarea>
                        </div>

                        <!-- Pagamento Confirmado -->
                        <div
                            style="background: rgba(76,175,80,0.1); border: 1px solid rgba(76,175,80,0.3); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <div>
                                    <h4 style="color: #4CAF50; margin: 0;">üí≥ Pagamento Confirmado</h4>
                                    <p style="color: rgba(255,255,255,0.6); font-size: 0.85rem; margin: 5px 0 0;">
                                        Enviada ap√≥s confirma√ß√£o de pagamento</p>
                                </div>
                                <label class="eio-switch">
                                    <input type="checkbox" id="togglePayment" checked>
                                    <span class="eio-switch-slider"></span>
                                </label>
                            </div>
                            <textarea class="eio-input" id="msgPayment" rows="3" style="width: 100%;">Ol√° {nome}! üéâ

Seu pagamento foi confirmado com sucesso! Obrigado por confiar no E.I.O System.

Sua assinatura est√° ativa at√© {data_vencimento}.

Boas automa√ß√µes!</textarea>
                        </div>

                        <!-- Lembrete de Renova√ß√£o -->
                        <div
                            style="background: rgba(255,193,7,0.1); border: 1px solid rgba(255,193,7,0.3); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <div>
                                    <h4 style="color: #FFC107; margin: 0;">‚è∞ Lembrete de Renova√ß√£o</h4>
                                    <p style="color: rgba(255,255,255,0.6); font-size: 0.85rem; margin: 5px 0 0;">
                                        Enviada 3 dias antes do vencimento</p>
                                </div>
                                <label class="eio-switch">
                                    <input type="checkbox" id="toggleRenewal" checked>
                                    <span class="eio-switch-slider"></span>
                                </label>
                            </div>
                            <textarea class="eio-input" id="msgRenewal" rows="3" style="width: 100%;">Ol√° {nome}! üëã

Sua assinatura do E.I.O vence em 3 dias ({data_vencimento}).

Renove agora para n√£o perder acesso √†s automa√ß√µes!</textarea>
                        </div>

                        <button class="eio-btn eio-btn-primary" id="btnSaveMessages" style="margin-top: 10px;">
                            üíæ Salvar Configura√ß√µes de Mensagens
                        </button>
                    </div>
                </div>
            </div>

            <!-- Finances Section -->
            <div class="eio-content-section" data-section="finances">
                <div class="eio-stats-grid" style="margin-bottom: 30px;">
                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Receita Mensal (MRR)</span>
                            <div class="eio-stat-icon eio-stat-icon-purple">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path
                                        d="M12 2V22M17 5H9.5C8.57174 5 7.6815 5.36875 7.02513 6.02513C6.36875 6.6815 6 7.57174 6 8.5C6 9.42826 6.36875 10.3185 7.02513 10.9749C7.6815 11.6313 8.57174 12 9.5 12H14.5C15.4283 12 16.3185 12.3687 16.9749 13.0251C17.6313 13.6815 18 14.5717 18 15.5C18 16.4283 17.6313 17.3185 16.9749 17.9749C16.3185 18.6313 15.4283 19 14.5 19H6"
                                        stroke="currentColor" stroke-width="2" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-finance-mrr">R$ 0,00</div>
                        <div class="eio-stat-change">Calculado automaticamente</div>
                    </div>
                    <div class="eio-stat-card">
                        <div class="eio-stat-header">
                            <span class="eio-stat-label">Total de Transa√ß√µes</span>
                            <div class="eio-stat-icon eio-stat-icon-blue">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M3 3H21V21H3V3Z" stroke="currentColor" stroke-width="2" />
                                    <path d="M7 8V16M12 11V16M17 6V16" stroke="currentColor" stroke-width="2" />
                                </svg>
                            </div>
                        </div>
                        <div class="eio-stat-value" id="stat-finance-transactions">0</div>
                        <div class="eio-stat-change">Neste m√™s</div>
                    </div>
                </div>

                <div class="eio-card" style="margin-top: 20px;">
                    <div class="eio-card-header">
                        <h3>Transa√ß√µes Recentes</h3>
                    </div>
                    <div class="eio-admin-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Cliente</th>
                                    <th>Descri√ß√£o</th>
                                    <th>Valor</th>
                                    <th>Status</th>
                                    <th>M√©todo</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsTableBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- System Logs Section -->
            <div class="eio-content-section" data-section="logs">
                <div class="eio-card">
                    <div class="eio-card-header">
                        <h3>Logs de Atividade</h3>
                        <button class="eio-btn eio-btn-ghost eio-btn-sm" id="btnClearLogs">Limpar</button>
                    </div>
                    <div class="eio-admin-table">
                        <div id="logsContainer"
                            style="background: #0a0a0a; color: #0f0; font-family: monospace; padding: 20px; border-radius: 8px; max-height: 400px; overflow-y: auto;">
                            <div style="color: #666;">Carregando logs...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ‚úÖ FIX SPACING SCRIPT - REMOVIDO PARA ROLLBACK -->
    <script>
        console.log('‚úÖ Spacing fix script removed for stability rollback to V6');
    </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="config.js"></script>
    <script src="api.js"></script>
    <script src="admin.js"></script>
</body>

</html>